webpackJsonp([2],{GjSh:function(t,e){},LJvT:function(t,e){},OIM7:function(t,e,a){"use strict";var s={name:"LoadImage",data:function(){return{loading:a("IaMB")}},props:["loadState"]},n={render:function(){var t=this.$createElement,e=this._self._c||t;return this.loadState?e("div",{staticClass:"box-center text-center"},[e("img",{staticStyle:{width:"133px",height:"80px"},attrs:{src:this.loading,alt:"正在加载中"}})]):this._e()},staticRenderFns:[]},i=a("VU/8")(s,n,!1,null,null,null);e.a=i.exports},T5m3:function(t,e,a){t.exports=a.p+"static/img/userOff.9b447df.png"},TfBY:function(t,e){},VzVh:function(t,e,a){"use strict";function s(t){return{userData:{userHeader:t.ybhead,userId:t.userid,userName:t.ybname},managerData:{id:t.id,managerPrice:t.price,createTime:t.createtime,updateTime:t.updatetime,imgUrl:JSON.parse(t.imgurl),managerDetail:t.detail,collections:t.collections,reviews:t.reviews,name:t.name,isDeal:t.isdeal}}}a.d(e,"a",function(){return s}),e.b=function(t){var e=this;return this.fetch.getJsonData("/secondhand/browse/article",{page:t,pagesize:10}).then(function(t){var a=t.content;return{managerList:a=a.map(s.bind(e)),pageData:function(t){var e=t.last,a=t.first,s=t.totalElements,n=t.totalPages,i=t.sort,r=t.numberOfElements,o=t.size;return{last:e,first:a,totalElements:s,totalPages:n,sort:i,number:t.number,numberOfElements:r,size:o}}(t)}})}},e6Jw:function(t,e){},gWTr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("//Fk"),n=a.n(s),i=a("mvHQ"),r=a.n(i),o=a("sOKA"),c=a("nuAC"),l=a("zIJf"),u=a("/qaa"),d=a("mi6u"),g={name:"Search",props:[],mixins:[c.a,l.a,Object(d.a)(u.a)],data:function(){return{value:"",chooseList:{chooseValue:[],chooseList:[]},isFocus:!1}},watch:{chooseList:function(){this.value="",this.isFocus=!0}},methods:{focus:function(){this.isFocus=!0},search:function(){this.isFocus=!1,this.$emit("fetchSearch",{name:this.value,choose:this.chooseList.chooseValue})}},components:{Classification:o.a}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"Search box-center",on:{click:function(e){return e.stopPropagation(),t.focus(e)}}},[a("div",{staticClass:"label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{type:"text",placeholder:"搜索宝贝"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),t._v(" "),t.isFocus?a("span",{on:{click:function(e){return e.stopPropagation(),t.search(e)}}},[t._v("搜索")]):t._e()]),t._v(" "),t.isFocus?a("div",{staticClass:"classification"},[a("classification",{attrs:{classesList:t.classesList,dataKey:"chooseList",choosed:t.chooseList.chooseList},on:{choose:t.updateData}})],1):t._e()])},staticRenderFns:[]};var f=a("VU/8")(g,h,!1,function(t){a("GjSh")},"data-v-d0a1a290",null).exports,m=a("OIM7"),p=a("vAZX"),v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ManagerDetails"},[a("ul",{staticClass:"clear"},[1===t.images.length?a("li",{staticClass:"float-left big"},[a("img",{attrs:{src:t.images[0]}})]):t._e(),t._v(" "),t._l(t.images,function(e,s){return 1!==t.images.length?a("li",{staticClass:"float-left"},[a("img",{class:{last:s===t.images.length-1},attrs:{src:e}})]):t._e()}),t._v(" "),t.images.length>1?a("li",{staticClass:"hide"}):t._e()],2),t._v(" "),a("p",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),a("p",{staticClass:"describe"},[t._v(t._s(t.describe.length<140?t.describe:t.describe.substr(0,140)+"..."))])])},staticRenderFns:[]};var _=a("VU/8")({name:"ManagerDetails",props:["images","title","describe"],data:function(){return{}}},v,!1,function(t){a("rg5X")},"data-v-d53a0dd8",null).exports,b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ManagerReply"},[a("div",{staticClass:"reply"},[a("div",{staticClass:"border-left"}),t._v(" "),t._l(t.replyList,function(e,s){return s<=1?a("p",[t._v("\n            "+t._s(e.user)+" : "+t._s(e.message)+"\n        ")]):t._e()})],2)])},staticRenderFns:[]};var L=a("VU/8")({name:"ManagerReply",data:function(){return{}},beforeMount:function(){},props:["replyList"]},b,!1,function(t){a("z2jB")},"data-v-8e16af24",null).exports,D={name:"index",props:["userData","managerImage","managerData"],data:function(){return{managerReplyList:[]}},components:{ManagerHeader:p.a,ManagerDetails:_,ManagerReply:L}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ManagerSection"},[a("manager-header",{attrs:{userData:t.userData,managerPrice:t.managerData.managerPrice}}),t._v(" "),a("manager-details",{attrs:{images:t.managerData.imgUrl,title:t.managerData.name,describe:t.managerData.managerDetail}}),t._v(" "),a("hr",{staticStyle:{border:"1px solid #EBEBEB","border-bottom":"none"}}),t._v(" "),a("ul",{staticClass:"clear manager-footer"},[a("li",{staticClass:"float-right"},[t._v("留言"+t._s(t.managerData.reviews))]),t._v(" "),a("li",{staticClass:"float-right"},[t._v(" · ")]),t._v(" "),a("li",{staticClass:"float-right"},[t._v("收藏"+t._s(t.managerData.collections))])])],1)},staticRenderFns:[]};var y=a("VU/8")(D,x,!1,function(t){a("e6Jw")},"data-v-68f14eea",null).exports,C=a("/MSx"),S=a("N1Zm"),P=a("c7dQ"),w=a("VzVh"),E={data:function(){return{pageList:[],nextPageNumber:1}},mounted:function(){window.addEventListener("scroll",this.scrollEvent)},beforeDestroy:function(){window.removeEventListener("scroll",this.scrollEvent)},methods:{addPage:function(t){return t.pageData.number>=this.nextPageNumber?-1:(this.pageList.push(t),this.pageList.length)},fetchNextPage:function(){var t=this,e=this.nextPageNumber;e>=this.pageList[0].pageData.totalPages||(this.nextPageNumber+=1,this.getManagerList(e).then(function(e){t.addPage(e)}))},scrollEvent:function(){var t=document.documentElement.scrollTop+document.body.scrollTop,e=document.documentElement.clientHeight,a=document.documentElement.offsetHeight;this.scrollTop=t,a>this.scrollTop+e-30&&a<this.scrollTop+e+30&&!this.restoring&&this.fetchNextPage()}}},k={name:"HomePage",mixins:[c.a,Object(d.a)(u.a),Object(P.a)(u.c),Object(S.a)("homepage"),E],data:function(){return{title:"石大易班跳蚤市场",find:a("mZY8"),user:a("T5m3"),pageList:[],pageListData:[],flag:!0,nextPageNumber:1}},created:function(){var t=this;this.restoreData().then(function(e){if(e.fromRestore){var a=JSON.parse(e.pageList);t.nextPageNumber=parseInt(e.nextPageNumber),a.forEach(function(e){t.addPage(e)}),window.scroll(0,parseInt(e.scroll))}else t.getManagerList(0).then(function(e){return t.addPage(e)})})},beforeDestroy:function(){var t={};t.pageList=r()(this.pageList),t.nextPageNumber=this.nextPageNumber,t.scroll=this.scrollTop?this.scrollTop:0,t.expire=(new Date).getTime()+6e5,t.fromRestore=!0,window.sessionStorage.status=r()(t)},components:{ManagerSection:y,HeaderSection:C.a,Search:f,LoadImage:m.a},methods:{backTop:function(){window.scrollTo(0,0)},setPageWithData:function(t){this.flag&&(this.pageListData=this.pageList,this.flag=!1),this.pageList=[{managerList:t.map(function(t){return Object(w.a)(t)}),pageData:this.pageList[0].pageData}]},fetchSearch:function(t){var e=this;t.name?this.fetch.getJsonData("/secondhand/browse/findbyarticlename",{name:t.name}).then(function(t){e.setPageWithData(t)}):t.choose&&t.choose.length>0?this.fetch.getJsonData("/secondhand/browse/findbyarticlekind",{kind:t.choose.join("%")}).then(function(t){e.setPageWithData(t)}):this.pageList=this.pageListData},restoreData:function(){return new n.a(function(t){window.sessionStorage.status||t(!1);var e=JSON.parse(window.sessionStorage.status);e.expire>=(new Date).getTime()?t(e):t(!1)})},getManagerList:w.b}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"HomePage second-market box-center"},[a("header-section",[a("p",[t._v("跳蚤市场")])]),t._v(" "),a("search",{on:{fetchSearch:t.fetchSearch}}),t._v(" "),a("load-image",{attrs:{loadState:t.loadState}}),t._v(" "),t.pageList.length<=0||t.pageList[0].managerList.length<=0?t._e():a("hr",{staticStyle:{border:"1px solid #EBEBEB","border-bottom":"none"}}),t._v(" "),t.pageList.length<=0||t.pageList[0].managerList.length<=0?a("p",{staticClass:"text-center",staticStyle:{color:"rgb(179, 167, 167)","font-size":"0.7rem","margin-top":"1rem"}},[t._v("\n        没有搜索结果\n    ")]):t._e(),t._v(" "),t._l(t.pageList,function(e,s){return a("div",{key:"page"+s,attrs:{"page-num":e.pageData.number}},t._l(e.managerList,function(t){return a("div",{key:"item"+t.managerData.id},[a("router-link",{staticStyle:{display:"block"},attrs:{to:"/second/details/"+t.managerData.id}},[a("manager-section",{staticClass:"bottom-style",attrs:{userData:t.userData,managerImage:t.managerData.imgUrl,managerData:t.managerData}})],1)],1)}))}),t._v(" "),a("load-image",{attrs:{loadState:t.loadState}}),t._v(" "),a("div",{staticStyle:{height:"6rem"}}),t._v(" "),a("div",{staticClass:"footer absolute-horizontal-center"},[a("ul",{staticClass:"clear"},[a("li",{staticClass:"float-left",on:{click:t.backTop}},[a("img",{attrs:{src:t.find}}),t._v(" "),a("p",[t._v("发现")])]),t._v(" "),a("li",{staticClass:"float-left add"},[a("router-link",{staticClass:"absolute-horizontal-center",staticStyle:{display:"block"},attrs:{to:"/second/publish"}},[a("span",[t._v("+")])]),t._v(" "),a("img",{staticStyle:{opacity:"0"},attrs:{src:""}}),t._v(" "),a("p",[t._v("发布")])],1),t._v(" "),a("li",{staticClass:"float-left"},[a("router-link",{attrs:{to:"/second/user-center"}},[a("img",{attrs:{src:t.user}}),t._v(" "),a("p",[t._v("我的")])])],1)])])],2)},staticRenderFns:[]};var T=a("VU/8")(k,M,!1,function(t){a("TfBY")},"data-v-8b159f90",null);e.default=T.exports},mZY8:function(t,e,a){t.exports=a.p+"static/img/findOn.2902e8d.png"},rMlh:function(t,e){},rg5X:function(t,e){},sOKA:function(t,e,a){"use strict";var s={name:"Classification",props:{classesList:{type:Array,default:function(){return[]}},dataKey:{type:String},choosed:{type:Array,default:function(){return[]}}},beforeMount:function(){this.chooseList=this._props.choosed},data:function(){return{chooseList:[]}},methods:{choose:function(t){var e=this,a=parseInt(t.target.dataset.index),s=this.chooseList.indexOf(a);-1===s?this.chooseList.push(a):this.chooseList.splice(s,1);var n=this.chooseList.sort().map(function(t){return e._props.classesList[t]});this.$emit("choose",{key:this._props.dataKey,value:{chooseValue:n,chooseList:this.chooseList}})},includes:function(t){return-1===this.chooseList.indexOf(t)?"":"border-color:black;color:black"}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"Classification"},[a("br"),t._v(" "),a("ul",{staticClass:"clear"},t._l(t.classesList,function(e,s){return a("li",{staticClass:"float-left",style:""+t.includes(s),attrs:{"data-index":s},on:{click:function(e){return e.stopPropagation(),t.choose(e)}}},[a("span",{attrs:{"data-index":s}},[t._v(t._s(e))])])}))])},staticRenderFns:[]};var i=a("VU/8")(s,n,!1,function(t){a("LJvT")},"data-v-a66ec9dc",null);e.a=i.exports},vAZX:function(t,e,a){"use strict";var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"UserBox"},[a("ul",{staticClass:"clear"},[a("li",[a("img",{attrs:{src:t.userData.userHeader}})]),t._v(" "),a("li",{staticClass:"second"},[a("span",[t._v(t._s(t.userData.userName))])]),t._v(" "),a("li",[a("p",[t._v("￥"+t._s(t.managerPrice))])])])])},staticRenderFns:[]};var n=a("VU/8")({name:"ManagerHeader",props:["userData","managerPrice"],data:function(){return{}}},s,!1,function(t){a("rMlh")},null,null);e.a=n.exports},z2jB:function(t,e){},zIJf:function(t,e,a){"use strict";e.a={data:function(){return{classesList:[]}},created:function(){var t=this;this.fetch.getJsonData("/secondhand/browse/allkind").then(function(e){t.classesList=e.map(function(t){return t.name})})}}}});
//# sourceMappingURL=2.ff39a45750fbc65f83d2.js.map